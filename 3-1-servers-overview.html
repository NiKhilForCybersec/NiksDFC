<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Microsoft Defender for Servers - P1 vs P2 comparison, features, deployment, and MDE integration.">
    <title>Defender for Servers - Microsoft Defender for Cloud</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">MDC</div>
                    <span class="logo-text">Defender for Cloud</span>
                </a>
                <button class="sidebar-toggle" aria-label="Toggle sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CWPP</div>
                    <div class="nav-group expanded" data-group="cwpp">
                        <div class="nav-group-header">
                            <span class="nav-group-title">Workload Protection</span>
                            <svg class="nav-group-toggle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="nav-group-items">
                            <a href="3-1-servers-overview.html" class="nav-subitem active">Defender for Servers</a>
                            <a href="3-2-vuln-assessment.html" class="nav-subitem">Vulnerability Assessment</a>
                            <a href="3-3-advanced-features.html" class="nav-subitem">Advanced Features</a>
                            <a href="3-4-containers.html" class="nav-subitem">Defender for Containers</a>
                            <a href="3-7-storage.html" class="nav-subitem">Defender for Storage</a>
                            <a href="3-8-sql.html" class="nav-subitem">Defender for SQL</a>
                            <a href="3-14-agentless.html" class="nav-subitem">Agentless Scanning</a>
                            <a href="3-15-jit.html" class="nav-subitem">JIT VM Access</a>
                        </div>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" aria-label="Open menu">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
                        </svg>
                        <input type="text" class="search-input" placeholder="Search documentation..." readonly>
                        <span class="search-shortcut">âŒ˜K</span>
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <article class="page-content">
                    <nav class="breadcrumbs">
                        <a href="index.html" class="breadcrumb-item">Home</a>
                        <span class="breadcrumb-separator">/</span>
                        <a href="3-1-servers-overview.html" class="breadcrumb-item">CWPP</a>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item current">Defender for Servers</span>
                    </nav>

                    <header class="page-header">
                        <h1>Defender for Servers</h1>
                        <div class="page-meta">
                            <span class="badge badge-l1">L1 Fundamentals</span>
                            <span class="badge badge-l2">L2 Technical</span>
                            <span class="page-meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                                </svg>
                                25 min read
                            </span>
                        </div>
                    </header>

                    <section>
                        <p>
                            Microsoft Defender for Servers provides comprehensive threat protection for Windows and Linux 
                            servers across Azure, on-premises, and multi-cloud environments. It integrates with Microsoft 
                            Defender for Endpoint (MDE) to deliver advanced EDR/XDR capabilities.
                        </p>

                        <div class="callout callout-success">
                            <svg class="callout-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
                            </svg>
                            <div class="callout-title">Key Benefit</div>
                            <div class="callout-content">
                                <p>Defender for Servers P2 includes full Microsoft Defender for Endpoint licensing at no 
                                additional cost - providing enterprise EDR capabilities that would typically cost $5-10/server/month separately.</p>
                            </div>
                        </div>
                    </section>

                    <!-- P1 vs P2 Comparison -->
                    <section>
                        <h2 id="p1-vs-p2">Plan 1 vs Plan 2 Comparison</h2>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>Plan 1 (P1)</th>
                                        <th>Plan 2 (P2)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Price (Azure VMs)</strong></td>
                                        <td>~$5/server/month</td>
                                        <td>~$15/server/month</td>
                                    </tr>
                                    <tr>
                                        <td><strong>MDE Integration</strong></td>
                                        <td class="text-green">âœ“ Included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>EDR (Endpoint Detection)</strong></td>
                                        <td class="text-green">âœ“ Full EDR</td>
                                        <td class="text-green">âœ“ Full EDR</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Threat Intelligence</strong></td>
                                        <td class="text-green">âœ“ Included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Vulnerability Assessment</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ MDVM + Qualys</td>
                                    </tr>
                                    <tr>
                                        <td><strong>File Integrity Monitoring</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Adaptive Application Controls</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Adaptive Network Hardening</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>JIT VM Access</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Agentless Scanning</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>OS Baseline Assessment</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Included</td>
                                    </tr>
                                    <tr>
                                        <td><strong>500MB Free Data Ingestion</strong></td>
                                        <td class="text-red">âœ— Not included</td>
                                        <td class="text-green">âœ“ Per server/day</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="callout callout-tip">
                            <svg class="callout-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0z" clip-rule="evenodd" />
                            </svg>
                            <div class="callout-title">Recommendation</div>
                            <div class="callout-content">
                                <p><strong>P2 is recommended for production workloads</strong>. The vulnerability assessment, 
                                JIT access, and 500MB/day data allowance typically justify the additional ~$10/month cost.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Architecture -->
                    <section>
                        <h2 id="architecture">Architecture Overview</h2>

                        <div class="ascii-diagram">
<span class="highlight-cyan">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="highlight-cyan">â•‘</span>                   <span class="highlight-blue">DEFENDER FOR SERVERS ARCHITECTURE</span>                                      <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£</span>
<span class="highlight-cyan">â•‘</span>                                                                                            <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚                              SERVER WORKLOADS                                    â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚  â”‚   Azure VMs    â”‚  â”‚    AWS EC2     â”‚  â”‚   GCP GCE      â”‚  â”‚  On-Premises   â”‚ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚  â”‚   (Native)     â”‚  â”‚  (via Arc)     â”‚  â”‚  (via Arc)     â”‚  â”‚   (via Arc)    â”‚ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚          â”‚                   â”‚                   â”‚                   â”‚          â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â”‚                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚   MDE AGENT (MSSense) â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚  â€¢ Process telemetry  â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚  â€¢ Network activity   â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚  â€¢ File operations    â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â”‚  â€¢ Memory scanning    â”‚</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                              <span class="highlight-orange">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>                                  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â”‚                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â–¼                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚                     MICROSOFT DEFENDER FOR ENDPOINT (Cloud)                      â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚  â”‚  Threat Intel  â”‚  â”‚   Behavioral   â”‚  â”‚    Incident    â”‚  â”‚   Response     â”‚ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚  â”‚    Engine      â”‚  â”‚   Analytics    â”‚  â”‚   Correlation  â”‚  â”‚    Actions     â”‚ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â”‚                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â–¼                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚                        DEFENDER FOR CLOUD PORTAL                                 â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   Alerts â”‚ Recommendations â”‚ Secure Score â”‚ Vulnerability Findings â”‚ JIT Access â”‚</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                                                            <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
                        </div>
                    </section>

                    <!-- Supported Platforms -->
                    <section>
                        <h2 id="platforms">Supported Platforms</h2>

                        <div class="tabs">
                            <div class="tab-list">
                                <button class="tab-btn active" data-tab="windows">Windows</button>
                                <button class="tab-btn" data-tab="linux">Linux</button>
                                <button class="tab-btn" data-tab="multicloud">Multi-Cloud</button>
                            </div>

                            <div class="tab-panel active" data-panel="windows">
                                <h4>Windows Server Support</h4>
                                <ul>
                                    <li>Windows Server 2022</li>
                                    <li>Windows Server 2019</li>
                                    <li>Windows Server 2016</li>
                                    <li>Windows Server 2012 R2 (with modern unified agent)</li>
                                    <li>Windows Server Core editions</li>
                                    <li>Windows 10/11 Enterprise multi-session (AVD)</li>
                                </ul>
                                
                                <div class="callout callout-warning" style="margin-top: var(--space-md);">
                                    <div class="callout-title">Legacy Support</div>
                                    <div class="callout-content">
                                        <p>Windows Server 2008/2008 R2 require the MMA agent and have limited functionality.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="tab-panel" data-panel="linux">
                                <h4>Linux Distribution Support</h4>
                                <ul>
                                    <li>Ubuntu 16.04, 18.04, 20.04, 22.04</li>
                                    <li>RHEL 7.x, 8.x, 9.x</li>
                                    <li>CentOS 7.x, 8.x</li>
                                    <li>Debian 9, 10, 11</li>
                                    <li>SUSE Linux Enterprise Server 12, 15</li>
                                    <li>Oracle Linux 7.x, 8.x</li>
                                    <li>Amazon Linux 2</li>
                                </ul>
                            </div>

                            <div class="tab-panel" data-panel="multicloud">
                                <h4>Multi-Cloud Coverage</h4>
                                <p>Coverage via Azure Arc:</p>
                                <ul>
                                    <li><strong>AWS:</strong> EC2 instances (Windows/Linux)</li>
                                    <li><strong>GCP:</strong> GCE VMs (Windows/Linux)</li>
                                    <li><strong>On-premises:</strong> Physical or virtual servers</li>
                                    <li><strong>Other clouds:</strong> Any reachable server via Arc</li>
                                </ul>
                                <p style="margin-top: var(--space-md);">Requires Azure Arc Connected Machine agent + MDE agent.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Enablement -->
                    <section>
                        <h2 id="enablement">Enablement Scripts</h2>

                        <h3 id="enable-azure">Enable for Azure VMs</h3>

                        <div class="code-header">
                            <span class="code-lang">Azure CLI</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-bash"># Enable Defender for Servers Plan 2
az security pricing create \
    --name VirtualMachines \
    --tier Standard \
    --subplan P2

# Verify enablement
az security pricing show --name VirtualMachines</code></pre>

                        <div class="code-header">
                            <span class="code-lang">PowerShell</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-powershell"># Enable Defender for Servers P2
Set-AzSecurityPricing `
    -Name "VirtualMachines" `
    -PricingTier "Standard" `
    -SubPlan "P2"

# Check MDE auto-provisioning
Get-AzSecurityAutoProvisioningSetting

# Enable MDE auto-provisioning
Set-AzSecurityAutoProvisioningSetting `
    -Name "default" `
    -EnableAutoProvision</code></pre>

                        <h3 id="enable-arc">Enable for Arc Servers (Multi-Cloud/On-Prem)</h3>

                        <div class="code-header">
                            <span class="code-lang">Bash</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-bash"># Step 1: Install Azure Arc agent (run on each server)
wget https://aka.ms/azcmagent -O azcmagent.sh
chmod +x azcmagent.sh
sudo ./azcmagent.sh connect \
    --tenant-id "your-tenant-id" \
    --subscription-id "your-subscription-id" \
    --resource-group "rg-arc-servers" \
    --location "eastus"

# Step 2: Install MDE extension via Arc
az connectedmachine extension create \
    --machine-name "your-server-name" \
    --resource-group "rg-arc-servers" \
    --name "MDE.Linux" \
    --publisher "Microsoft.Azure.AzureDefenderForServers" \
    --type "MDE.Linux" \
    --settings '{"autoUpdate": true}'</code></pre>
                    </section>

                    <!-- Alert Types -->
                    <section>
                        <h2 id="alerts">Common Alert Types</h2>

                        <div class="table-wrapper">
                            <table class="table-compact">
                                <thead>
                                    <tr>
                                        <th>Alert Category</th>
                                        <th>Examples</th>
                                        <th>MITRE Tactic</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Malware Detection</strong></td>
                                        <td>Ransomware, trojans, coin miners</td>
                                        <td>Execution, Impact</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Suspicious Process</strong></td>
                                        <td>PowerShell download cradles, encoded commands</td>
                                        <td>Execution, Defense Evasion</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Brute Force</strong></td>
                                        <td>RDP/SSH failed login attempts</td>
                                        <td>Initial Access, Credential Access</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Lateral Movement</strong></td>
                                        <td>WMI/PSExec usage, pass-the-hash</td>
                                        <td>Lateral Movement</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Persistence</strong></td>
                                        <td>Scheduled tasks, registry run keys</td>
                                        <td>Persistence</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Data Exfiltration</strong></td>
                                        <td>Unusual outbound data transfers</td>
                                        <td>Exfiltration</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Defender for Servers alerts - Last 7 days
SecurityAlert
| where TimeGenerated > ago(7d)
| where ProductName == "Azure Security Center"
| where AlertName has_any ("VM", "process", "malware", "brute", "RDP", "SSH")
| summarize 
    Count = count(),
    Resources = make_set(CompromisedEntity)
    by AlertName, AlertSeverity
| order by Count desc</code></pre>
                    </section>

                    <!-- Key Takeaways -->
                    <div class="key-takeaways">
                        <div class="key-takeaways-title">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 2a.75.75 0 01.75.75v.258a33.186 33.186 0 016.668.83.75.75 0 01-.336 1.461z" clip-rule="evenodd" />
                            </svg>
                            Key Takeaways
                        </div>
                        <ul>
                            <li>P2 is recommended for production - includes vuln assessment, FIM, JIT, and 500MB/day data allowance</li>
                            <li>Both plans include full MDE (EDR) capabilities - significant cost savings</li>
                            <li>Multi-cloud and on-prem servers require Azure Arc agent</li>
                            <li>MDE agent auto-provisioning should be enabled for automatic deployment</li>
                            <li>Supports Windows Server 2012 R2+ and major Linux distributions</li>
                            <li>Alerts integrate with Sentinel for unified SOC operations</li>
                        </ul>
                    </div>

                    <div class="related-pages">
                        <div class="related-title">Related Pages</div>
                        <div class="related-list">
                            <a href="3-2-vuln-assessment.html" class="related-link">Vulnerability Assessment</a>
                            <a href="3-3-advanced-features.html" class="related-link">Advanced Features (FIM, AAC)</a>
                            <a href="3-15-jit.html" class="related-link">JIT VM Access</a>
                            <a href="1-8-agents.html" class="related-link">Agent Architecture</a>
                        </div>
                    </div>

                    <nav class="page-nav">
                        <a href="2-12-best-practices.html" class="page-nav-link prev">
                            <span class="page-nav-label">â† Previous</span>
                            <span class="page-nav-title">CSPM Best Practices</span>
                        </a>
                        <a href="3-2-vuln-assessment.html" class="page-nav-link next">
                            <span class="page-nav-label">Next â†’</span>
                            <span class="page-nav-title">Vulnerability Assessment</span>
                        </a>
                    </nav>
                </article>

                <aside class="toc-sidebar">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#p1-vs-p2" class="toc-link">P1 vs P2 Comparison</a></li>
                        <li class="toc-item"><a href="#architecture" class="toc-link">Architecture</a></li>
                        <li class="toc-item"><a href="#platforms" class="toc-link">Supported Platforms</a></li>
                        <li class="toc-item"><a href="#enablement" class="toc-link">Enablement Scripts</a></li>
                        <li class="toc-item"><a href="#enable-azure" class="toc-link toc-h3">Azure VMs</a></li>
                        <li class="toc-item"><a href="#enable-arc" class="toc-link toc-h3">Arc Servers</a></li>
                        <li class="toc-item"><a href="#alerts" class="toc-link">Alert Types</a></li>
                    </ul>
                </aside>
            </div>
        </main>
        <div class="mobile-overlay"></div>
    </div>

    <div class="search-modal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" placeholder="Search documentation..." autofocus>
            <div class="search-results"></div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>
