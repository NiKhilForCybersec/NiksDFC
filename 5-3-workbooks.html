<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sentinel Workbooks - Pre-built and custom workbooks for MDC data visualization in Microsoft Sentinel.">
    <title>Sentinel Workbooks - Microsoft Defender for Cloud</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../index.html" class="sidebar-logo">
                    <div class="logo-icon">MDC</div>
                    <span class="logo-text">Defender for Cloud</span>
                </a>
                <button class="sidebar-toggle" aria-label="Toggle sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Sentinel Integration</div>
                    <div class="nav-group expanded" data-group="sentinel">
                        <div class="nav-group-header">
                            <span class="nav-group-title">Microsoft Sentinel</span>
                            <svg class="nav-group-toggle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="nav-group-items">
                            <a href="5-1-integration-arch.html" class="nav-subitem">Integration Architecture</a>
                            <a href="5-2-data-connectors.html" class="nav-subitem">Data Connectors</a>
                            <a href="5-3-workbooks.html" class="nav-subitem active">Workbooks</a>
                            <a href="5-12-playbooks.html" class="nav-subitem">Automation Playbooks</a>
                        </div>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" aria-label="Open menu">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
                        </svg>
                        <input type="text" class="search-input" placeholder="Search documentation..." readonly>
                        <span class="search-shortcut">‚åòK</span>
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <article class="page-content">
                    <nav class="breadcrumbs">
                        <a href="../index.html" class="breadcrumb-item">Home</a>
                        <span class="breadcrumb-separator">/</span>
                        <a href="5-1-integration-arch.html" class="breadcrumb-item">Sentinel</a>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item current">Workbooks</span>
                    </nav>

                    <header class="page-header">
                        <h1>Sentinel Workbooks</h1>
                        <div class="page-meta">
                            <span class="badge badge-l2">L2 Technical</span>
                            <span class="page-meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                                </svg>
                                11 min read
                            </span>
                        </div>
                    </header>

                    <section>
                        <p>
                            Microsoft Sentinel workbooks provide interactive dashboards for visualizing MDC 
                            security data. Use built-in templates or create custom workbooks for executive 
                            reporting, SOC operations, and compliance tracking.
                        </p>
                    </section>

                    <!-- Built-in Workbooks -->
                    <section>
                        <h2 id="builtin">Built-in MDC Workbooks</h2>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Workbook</th>
                                        <th>Purpose</th>
                                        <th>Key Visualizations</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Microsoft Defender for Cloud</strong></td>
                                        <td>Overview dashboard</td>
                                        <td>Alerts by severity, recommendations, secure score</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Secure Score Over Time</strong></td>
                                        <td>Score trending</td>
                                        <td>Score history, control breakdown, subscription comparison</td>
                                    </tr>
                                    <tr>
                                        <td><strong>System Updates</strong></td>
                                        <td>Patch compliance</td>
                                        <td>Missing updates by severity, OS type, resource</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Vulnerability Assessment</strong></td>
                                        <td>CVE tracking</td>
                                        <td>Vulnerabilities by severity, age, remediation status</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Compliance Over Time</strong></td>
                                        <td>Regulatory tracking</td>
                                        <td>Compliance trends, failed controls, improvement areas</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h3>Deploy Built-in Workbooks</h3>
                        <ol>
                            <li>Navigate to <strong>Microsoft Sentinel</strong> ‚Üí <strong>Workbooks</strong></li>
                            <li>Click <strong>Templates</strong> tab</li>
                            <li>Search for "Defender for Cloud"</li>
                            <li>Select workbook ‚Üí Click <strong>Save</strong></li>
                            <li>Choose resource group ‚Üí <strong>OK</strong></li>
                        </ol>
                    </section>

                    <!-- Custom Executive Dashboard -->
                    <section>
                        <h2 id="executive">Executive Dashboard Queries</h2>

                        <h3>Security Posture Summary</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Executive KPI Summary
let AlertsLast30d = SecurityAlert
| where TimeGenerated > ago(30d)
| where ProviderName == "Azure Security Center"
| summarize 
    TotalAlerts = count(),
    Critical = countif(AlertSeverity == "High"),
    Resolved = countif(Status == "Resolved");

let Score = SecureScore_CL
| where TimeGenerated > ago(1d)
| summarize CurrentScore = avg(Score_d), MaxScore = avg(MaxScore_d);

AlertsLast30d
| extend Placeholder = 1
| join kind=inner (Score | extend Placeholder = 1) on Placeholder
| project 
    TotalAlerts,
    CriticalAlerts = Critical,
    ResolvedAlerts = Resolved,
    ResolutionRate = round(100.0 * Resolved / TotalAlerts, 1),
    SecureScorePercent = round(100.0 * CurrentScore / MaxScore, 1)</code></pre>

                        <h3>Alert Trend Chart</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Alert trend over 30 days
SecurityAlert
| where TimeGenerated > ago(30d)
| where ProviderName == "Azure Security Center"
| summarize 
    High = countif(AlertSeverity == "High"),
    Medium = countif(AlertSeverity == "Medium"),
    Low = countif(AlertSeverity == "Low")
    by bin(TimeGenerated, 1d)
| render timechart</code></pre>

                        <h3>Top Affected Resources</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Resources with most alerts
SecurityAlert
| where TimeGenerated > ago(30d)
| where ProviderName == "Azure Security Center"
| extend Resource = tostring(parse_json(ExtendedProperties).["Compromised Host"])
| where isnotempty(Resource)
| summarize AlertCount = count(), 
            Severities = make_set(AlertSeverity)
            by Resource
| top 10 by AlertCount desc
| render barchart</code></pre>
                    </section>

                    <!-- SOC Operations Dashboard -->
                    <section>
                        <h2 id="soc">SOC Operations Dashboard</h2>

                        <h3>Active Alerts Queue</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Active alerts for SOC queue
SecurityAlert
| where ProviderName == "Azure Security Center"
| where Status == "Active" or Status == "New"
| extend 
    Resource = tostring(parse_json(ExtendedProperties).["Compromised Host"]),
    Subscription = tostring(parse_json(ExtendedProperties).SubscriptionId)
| project 
    TimeGenerated,
    AlertName,
    AlertSeverity,
    Resource,
    Status,
    Description
| order by 
    case(AlertSeverity == "High", 1, AlertSeverity == "Medium", 2, 3),
    TimeGenerated desc</code></pre>

                        <h3>Mean Time to Resolve</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// MTTR by severity
SecurityAlert
| where TimeGenerated > ago(30d)
| where ProviderName == "Azure Security Center"
| where Status == "Resolved"
| extend ResolvedTime = todatetime(ExtendedProperties.ResolvedTime)
| where isnotempty(ResolvedTime)
| extend ResolutionMinutes = datetime_diff('minute', ResolvedTime, TimeGenerated)
| summarize 
    AvgMTTR_Hours = round(avg(ResolutionMinutes) / 60, 1),
    MedianMTTR_Hours = round(percentile(ResolutionMinutes, 50) / 60, 1),
    AlertCount = count()
    by AlertSeverity
| order by case(AlertSeverity == "High", 1, AlertSeverity == "Medium", 2, 3)</code></pre>

                        <h3>Alerts by MITRE ATT&CK</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// MITRE ATT&CK coverage
SecurityAlert
| where TimeGenerated > ago(30d)
| where ProviderName == "Azure Security Center"
| extend Tactics = todynamic(Tactics)
| mv-expand Tactic = Tactics
| summarize AlertCount = count() by tostring(Tactic)
| order by AlertCount desc
| render piechart</code></pre>
                    </section>

                    <!-- Compliance Dashboard -->
                    <section>
                        <h2 id="compliance">Compliance Dashboard</h2>

                        <h3>Compliance Score by Standard</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Compliance by regulatory standard
SecurityRegulatoryCompliance
| where TimeGenerated > ago(1d)
| summarize 
    PassedControls = countif(ComplianceState == "Passed"),
    FailedControls = countif(ComplianceState == "Failed"),
    TotalControls = count()
    by ComplianceStandard
| extend CompliancePercent = round(100.0 * PassedControls / TotalControls, 1)
| project ComplianceStandard, CompliancePercent, PassedControls, FailedControls
| order by CompliancePercent desc</code></pre>

                        <h3>Failed Controls Detail</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Top failed compliance controls
SecurityRegulatoryCompliance
| where TimeGenerated > ago(1d)
| where ComplianceState == "Failed"
| summarize FailureCount = count() by ComplianceControl, ComplianceStandard
| top 20 by FailureCount desc
| render barchart</code></pre>
                    </section>

                    <!-- Create Custom Workbook -->
                    <section>
                        <h2 id="create">Create Custom Workbook</h2>

                        <h3>Step-by-Step Guide</h3>
                        <ol>
                            <li>Navigate to <strong>Microsoft Sentinel</strong> ‚Üí <strong>Workbooks</strong></li>
                            <li>Click <strong>+ Add workbook</strong></li>
                            <li>Click <strong>Edit</strong> to enter edit mode</li>
                            <li>Add components:
                                <ul>
                                    <li><strong>Add query</strong>: KQL visualizations</li>
                                    <li><strong>Add text</strong>: Headers, descriptions</li>
                                    <li><strong>Add parameters</strong>: Time range, filters</li>
                                    <li><strong>Add group</strong>: Organize sections</li>
                                </ul>
                            </li>
                            <li>Click <strong>Done Editing</strong></li>
                            <li>Click <strong>Save</strong> ‚Üí Choose name and resource group</li>
                        </ol>

                        <h3>Add Time Range Parameter</h3>
                        <div class="code-header">
                            <span class="code-lang">JSON</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-json">{
  "type": 1,
  "content": {
    "json": "## MDC Security Dashboard\nSelect time range to filter all visualizations."
  }
},
{
  "type": 9,
  "content": {
    "parameters": [
      {
        "name": "TimeRange",
        "type": 4,
        "value": "P7D",
        "typeSettings": {
          "selectableValues": [
            {"durationMs": 86400000, "displayName": "Last 24 hours"},
            {"durationMs": 604800000, "displayName": "Last 7 days"},
            {"durationMs": 2592000000, "displayName": "Last 30 days"}
          ]
        }
      }
    ]
  }
}</code></pre>

                        <h3>Use Parameter in Query</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Use TimeRange parameter
SecurityAlert
| where TimeGenerated {TimeRange}
| where ProviderName == "Azure Security Center"
| summarize Count = count() by AlertSeverity</code></pre>
                    </section>

                    <!-- Export and Share -->
                    <section>
                        <h2 id="share">Export and Share</h2>

                        <div class="tabs">
                            <div class="tab-list">
                                <button class="tab-btn active" data-tab="export-pdf">Export PDF</button>
                                <button class="tab-btn" data-tab="share-link">Share Link</button>
                                <button class="tab-btn" data-tab="schedule">Schedule</button>
                            </div>

                            <div class="tab-panel active" data-panel="export-pdf">
                                <ol>
                                    <li>Open the workbook</li>
                                    <li>Click <strong>...</strong> (More) menu</li>
                                    <li>Select <strong>Export to PDF</strong></li>
                                    <li>Choose paper size and orientation</li>
                                    <li>Click <strong>Download</strong></li>
                                </ol>
                            </div>

                            <div class="tab-panel" data-panel="share-link">
                                <ol>
                                    <li>Open the workbook</li>
                                    <li>Click <strong>Share</strong> icon</li>
                                    <li>Copy the direct link</li>
                                    <li>Recipients need Reader access to workspace</li>
                                </ol>
                            </div>

                            <div class="tab-panel" data-panel="schedule">
                                <p>Use Logic Apps to schedule workbook reports:</p>
                                <ol>
                                    <li>Create Logic App with Recurrence trigger</li>
                                    <li>Add "Run query and visualize results" action</li>
                                    <li>Use same KQL queries from workbook</li>
                                    <li>Send via email with HTML table or chart</li>
                                </ol>
                            </div>
                        </div>
                    </section>

                    <!-- Workbook Templates -->
                    <section>
                        <h2 id="templates">Community Templates</h2>

                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">
                                    <span class="card-icon">üìä</span>
                                    <h3 class="card-title">Azure Security Benchmark</h3>
                                </div>
                                <div class="card-content">
                                    <p>ASB compliance tracking with detailed control mapping</p>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <span class="card-icon">üéØ</span>
                                    <h3 class="card-title">Attack Path Analysis</h3>
                                </div>
                                <div class="card-content">
                                    <p>Visualize attack paths and exposure metrics</p>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <span class="card-icon">‚òÅÔ∏è</span>
                                    <h3 class="card-title">Multi-Cloud Security</h3>
                                </div>
                                <div class="card-content">
                                    <p>Cross-cloud security posture comparison</p>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <span class="card-icon">üí∞</span>
                                    <h3 class="card-title">MDC Cost Analysis</h3>
                                </div>
                                <div class="card-content">
                                    <p>Defender plan costs by resource and subscription</p>
                                </div>
                            </div>
                        </div>

                        <div class="callout callout-info">
                            <div class="callout-title">GitHub Templates</div>
                            <div class="callout-content">
                                <p>Find additional workbook templates at:</p>
                                <code>github.com/Azure/Azure-Sentinel/tree/master/Workbooks</code>
                            </div>
                        </div>
                    </section>

                    <!-- Best Practices -->
                    <section>
                        <h2 id="best-practices">Best Practices</h2>

                        <div class="checklist">
                            <div class="checklist-title">Workbook Best Practices</div>
                            <ul>
                                <li>
                                    <input type="checkbox" id="wb1">
                                    <label for="wb1">Use parameters for time range and filters</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb2">
                                    <label for="wb2">Group related visualizations together</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb3">
                                    <label for="wb3">Add text descriptions for context</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb4">
                                    <label for="wb4">Optimize queries for performance</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb5">
                                    <label for="wb5">Create separate workbooks for different audiences</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb6">
                                    <label for="wb6">Test with different time ranges</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb7">
                                    <label for="wb7">Export to ARM template for version control</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="wb8">
                                    <label for="wb8">Schedule automated reports for stakeholders</label>
                                </li>
                            </ul>
                        </div>
                    </section>

                    <!-- Key Takeaways -->
                    <div class="key-takeaways">
                        <div class="key-takeaways-title">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 2a.75.75 0 01.75.75v.258a33.186 33.186 0 016.668.83.75.75 0 01-.336 1.461z" clip-rule="evenodd" />
                            </svg>
                            Key Takeaways
                        </div>
                        <ul>
                            <li>Built-in workbooks available for quick deployment</li>
                            <li>Create custom workbooks for specific reporting needs</li>
                            <li>Use parameters for interactive filtering</li>
                            <li>Executive dashboards: KPIs, trends, top affected resources</li>
                            <li>SOC dashboards: Alert queue, MTTR, MITRE coverage</li>
                            <li>Compliance dashboards: Standards comparison, failed controls</li>
                            <li>Export to PDF or share links for stakeholders</li>
                            <li>Schedule automated reports via Logic Apps</li>
                        </ul>
                    </div>

                    <div class="related-pages">
                        <div class="related-title">Related Pages</div>
                        <div class="related-list">
                            <a href="5-2-data-connectors.html" class="related-link">Data Connectors</a>
                            <a href="12-1-kql-library.html" class="related-link">KQL Library</a>
                            <a href="2-1-secure-score.html" class="related-link">Secure Score</a>
                            <a href="8-1-soc-overview.html" class="related-link">SOC Operations</a>
                        </div>
                    </div>

                    <nav class="page-nav">
                        <a href="5-2-data-connectors.html" class="page-nav-link prev">
                            <span class="page-nav-label">‚Üê Previous</span>
                            <span class="page-nav-title">Data Connectors</span>
                        </a>
                        <a href="5-12-playbooks.html" class="page-nav-link next">
                            <span class="page-nav-label">Next ‚Üí</span>
                            <span class="page-nav-title">Playbooks</span>
                        </a>
                    </nav>
                </article>

                <aside class="toc-sidebar">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#builtin" class="toc-link">Built-in Workbooks</a></li>
                        <li class="toc-item"><a href="#executive" class="toc-link">Executive Dashboard</a></li>
                        <li class="toc-item"><a href="#soc" class="toc-link">SOC Dashboard</a></li>
                        <li class="toc-item"><a href="#compliance" class="toc-link">Compliance Dashboard</a></li>
                        <li class="toc-item"><a href="#create" class="toc-link">Create Custom</a></li>
                        <li class="toc-item"><a href="#share" class="toc-link">Export & Share</a></li>
                        <li class="toc-item"><a href="#templates" class="toc-link">Templates</a></li>
                        <li class="toc-item"><a href="#best-practices" class="toc-link">Best Practices</a></li>
                    </ul>
                </aside>
            </div>
        </main>
        <div class="mobile-overlay"></div>
    </div>

    <div class="search-modal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" placeholder="Search documentation..." autofocus>
            <div class="search-results"></div>
        </div>
    </div>

    <script src="../js/main.js"></script>
</body>
</html>
