<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Agentless Scanning - Vulnerability assessment and secret scanning for VMs without deploying agents.">
    <title>Agentless Scanning - Microsoft Defender for Cloud</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">MDC</div>
                    <span class="logo-text">Defender for Cloud</span>
                </a>
                <button class="sidebar-toggle" aria-label="Toggle sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CWPP</div>
                    <div class="nav-group expanded" data-group="cwpp">
                        <div class="nav-group-header">
                            <span class="nav-group-title">Defender for Servers</span>
                            <svg class="nav-group-toggle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="nav-group-items">
                            <a href="3-1-servers-overview.html" class="nav-subitem">Servers Overview</a>
                            <a href="3-2-servers-p1-p2.html" class="nav-subitem">P1 vs P2</a>
                            <a href="3-3-mde-integration.html" class="nav-subitem">MDE Integration</a>
                            <a href="3-14-agentless-scanning.html" class="nav-subitem active">Agentless Scanning</a>
                            <a href="3-15-jit-access.html" class="nav-subitem">JIT VM Access</a>
                        </div>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" aria-label="Open menu">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
                        </svg>
                        <input type="text" class="search-input" placeholder="Search documentation..." readonly>
                        <span class="search-shortcut">âŒ˜K</span>
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <article class="page-content">
                    <nav class="breadcrumbs">
                        <a href="index.html" class="breadcrumb-item">Home</a>
                        <span class="breadcrumb-separator">/</span>
                        <a href="3-1-servers-overview.html" class="breadcrumb-item">CWPP</a>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item current">Agentless Scanning</span>
                    </nav>

                    <header class="page-header">
                        <h1>Agentless Scanning</h1>
                        <div class="page-meta">
                            <span class="badge badge-l1">L1 Fundamentals</span>
                            <span class="badge badge-l2">L2 Technical</span>
                            <span class="page-meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                                </svg>
                                15 min read
                            </span>
                            <span class="badge" style="background: var(--accent-purple-glow); color: var(--accent-purple);">Defender CSPM / P2</span>
                        </div>
                    </header>

                    <section>
                        <p>
                            Agentless scanning provides vulnerability assessment, software inventory, and secret 
                            detection for Azure VMs without deploying any agents. It uses disk snapshots to 
                            analyze VM contents safely and non-intrusively.
                        </p>

                        <div class="callout callout-success">
                            <div class="callout-title">Key Benefits</div>
                            <div class="callout-content">
                                <ul>
                                    <li><strong>No agent deployment</strong> - Zero footprint on VMs</li>
                                    <li><strong>No performance impact</strong> - Scans disk snapshots, not running VMs</li>
                                    <li><strong>Broad coverage</strong> - Works with any VM regardless of OS state</li>
                                    <li><strong>Secret detection</strong> - Finds exposed credentials in files</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- How It Works -->
                    <section>
                        <h2 id="how-it-works">How It Works</h2>

                        <div class="ascii-diagram">
<span class="highlight-cyan">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="highlight-cyan">â•‘</span>                         <span class="highlight-blue">AGENTLESS SCANNING ARCHITECTURE</span>                                   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£</span>
<span class="highlight-cyan">â•‘</span>                                                                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>                                                                       <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚    Azure VM     â”‚</span>     No agent installed                                               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   (Running)     â”‚</span>     No performance impact                                            <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>                                                                       <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â”‚                                                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â”‚ Managed Disk                                                                   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â–¼                                                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="highlight-green">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="highlight-purple">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚  Disk Snapshot  â”‚</span>â”€â”€â”€â”€â”€â–º<span class="highlight-green">â”‚  MDC Scanner    â”‚</span>â”€â”€â”€â”€â”€â–º<span class="highlight-purple">â”‚    Results      â”‚</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚  (Temporary)    â”‚</span>      <span class="highlight-green">â”‚  (Isolated)     â”‚</span>      <span class="highlight-purple">â”‚                 â”‚</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="highlight-green">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="highlight-purple">â”‚ â€¢ Vulnerabilitiesâ”‚</span>              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â”‚                      â”‚                 <span class="highlight-purple">â”‚ â€¢ Software inv.  â”‚</span>              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â”‚                      â”‚                 <span class="highlight-purple">â”‚ â€¢ Secrets        â”‚</span>              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â–¼                      â–¼                 <span class="highlight-purple">â”‚ â€¢ Malware        â”‚</span>              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="highlight-green">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="highlight-purple">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”‚    Deleted      â”‚</span>      <span class="highlight-green">â”‚  Data stays in  â”‚</span>               â”‚                        <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”‚  after scan     â”‚</span>      <span class="highlight-green">â”‚  your tenant    â”‚</span>               â–¼                        <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="highlight-green">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="highlight-blue">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                     <span class="highlight-blue">â”‚  Defender for   â”‚</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                     <span class="highlight-blue">â”‚     Cloud       â”‚</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                     <span class="highlight-blue">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>               <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">Scan Frequency: Every 24 hours</span>                                                           <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-green">Snapshot Retention: Deleted immediately after scan</span>                                       <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
                        </div>

                        <div class="callout callout-info">
                            <div class="callout-title">Data Privacy</div>
                            <div class="callout-content">
                                <p>Disk snapshots are created in your subscription and processed in your region. 
                                No disk data leaves your tenant. Snapshots are deleted immediately after scanning.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Capabilities -->
                    <section>
                        <h2 id="capabilities">Scanning Capabilities</h2>

                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-icon" style="background: var(--accent-red-glow); color: var(--accent-red);">ğŸ”</div>
                                    <h4 class="card-title">Vulnerability Assessment</h4>
                                </div>
                                <div class="card-content">
                                    <ul>
                                        <li>OS vulnerabilities (CVEs)</li>
                                        <li>Application vulnerabilities</li>
                                        <li>Missing patches</li>
                                        <li>CVSS scoring</li>
                                        <li>Remediation guidance</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <div class="card-icon" style="background: var(--accent-orange-glow); color: var(--accent-orange);">ğŸ“¦</div>
                                    <h4 class="card-title">Software Inventory</h4>
                                </div>
                                <div class="card-content">
                                    <ul>
                                        <li>Installed applications</li>
                                        <li>Package versions</li>
                                        <li>Running services</li>
                                        <li>Software bill of materials</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <div class="card-icon" style="background: var(--accent-purple-glow); color: var(--accent-purple);">ğŸ”</div>
                                    <h4 class="card-title">Secret Scanning</h4>
                                </div>
                                <div class="card-content">
                                    <ul>
                                        <li>Plaintext passwords</li>
                                        <li>API keys</li>
                                        <li>Connection strings</li>
                                        <li>SSH private keys</li>
                                        <li>Certificates</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <div class="card-icon" style="background: var(--accent-green-glow); color: var(--accent-green);">ğŸ¦ </div>
                                    <h4 class="card-title">Malware Detection</h4>
                                </div>
                                <div class="card-content">
                                    <ul>
                                        <li>Known malware signatures</li>
                                        <li>Crypto miners</li>
                                        <li>Web shells</li>
                                        <li>Rootkits</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Prerequisites -->
                    <section>
                        <h2 id="prerequisites">Prerequisites</h2>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Requirement</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Plan Required</strong></td>
                                        <td>Defender CSPM or Defender for Servers P2</td>
                                    </tr>
                                    <tr>
                                        <td><strong>VM Types</strong></td>
                                        <td>Azure VMs with managed disks (Windows & Linux)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Disk Encryption</strong></td>
                                        <td>Supports Azure Disk Encryption (ADE) and PMK/CMK</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Disk Size</strong></td>
                                        <td>Up to 1TB OS disk</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Not Supported</strong></td>
                                        <td>Unmanaged disks, Ultra disks, Ephemeral OS disks</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- Enablement -->
                    <section>
                        <h2 id="enablement">Enable Agentless Scanning</h2>

                        <div class="tabs">
                            <div class="tab-list">
                                <button class="tab-btn active" data-tab="portal-agentless">Portal</button>
                                <button class="tab-btn" data-tab="cli-agentless">Azure CLI</button>
                                <button class="tab-btn" data-tab="ps-agentless">PowerShell</button>
                            </div>

                            <div class="tab-panel active" data-panel="portal-agentless">
                                <h4>Enable via Portal</h4>
                                <ol>
                                    <li>Azure Portal â†’ Defender for Cloud â†’ Environment settings</li>
                                    <li>Select your subscription</li>
                                    <li>Click on "Defender CSPM" or "Servers" plan</li>
                                    <li>Under settings, enable "Agentless scanning for machines"</li>
                                    <li>Optionally enable "Secrets scanning"</li>
                                    <li>Save changes</li>
                                </ol>
                            </div>

                            <div class="tab-panel" data-panel="cli-agentless">
                                <div class="code-header">
                                    <span class="code-lang">Azure CLI</span>
                                    <button class="code-copy-btn">Copy</button>
                                </div>
                                <pre><code class="language-bash"># Enable Defender CSPM with agentless scanning
az security pricing create \
    --name CloudPosture \
    --tier Standard \
    --extensions '[
        {"name": "AgentlessVmScanning", "isEnabled": "True"},
        {"name": "AgentlessDiscoveryForKubernetes", "isEnabled": "True"},
        {"name": "SensitiveDataDiscovery", "isEnabled": "True"}
    ]'

# Or enable for Defender for Servers P2
az security pricing create \
    --name VirtualMachines \
    --tier Standard \
    --subplan P2 \
    --extensions '[
        {"name": "AgentlessVmScanning", "isEnabled": "True"}
    ]'

# Verify settings
az security pricing show --name CloudPosture</code></pre>
                            </div>

                            <div class="tab-panel" data-panel="ps-agentless">
                                <div class="code-header">
                                    <span class="code-lang">PowerShell</span>
                                    <button class="code-copy-btn">Copy</button>
                                </div>
                                <pre><code class="language-powershell"># Enable via REST API (PowerShell wrapper)
$subscriptionId = (Get-AzContext).Subscription.Id

$body = @{
    properties = @{
        pricingTier = "Standard"
        subPlan = "P2"
        extensions = @(
            @{
                name = "AgentlessVmScanning"
                isEnabled = "True"
            }
        )
    }
} | ConvertTo-Json -Depth 5

Invoke-AzRestMethod -Method PUT `
    -Path "/subscriptions/$subscriptionId/providers/Microsoft.Security/pricings/VirtualMachines?api-version=2024-01-01" `
    -Payload $body</code></pre>
                            </div>
                        </div>
                    </section>

                    <!-- View Results -->
                    <section>
                        <h2 id="view-results">Viewing Scan Results</h2>

                        <h3>Vulnerabilities</h3>
                        <p>Azure Portal â†’ Defender for Cloud â†’ Recommendations â†’ Filter by "Machines should have vulnerability findings resolved"</p>

                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Agentless vulnerability findings
SecurityRecommendation
| where RecommendationName contains "vulnerability"
| where RecommendationState == "Unhealthy"
| extend VulnDetails = parse_json(Properties)
| project 
    VM = AssessedResourceId,
    Severity = RecommendationSeverity,
    CVEs = VulnDetails.vulnerabilities
| mv-expand CVEs
| summarize 
    TotalVulns = count(),
    Critical = countif(CVEs.severity == "Critical"),
    High = countif(CVEs.severity == "High")
    by VM</code></pre>

                        <h3>Software Inventory</h3>
                        <p>Azure Portal â†’ Defender for Cloud â†’ Inventory â†’ Select VM â†’ Software inventory tab</p>

                        <div class="code-header">
                            <span class="code-lang">Azure Resource Graph</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Query software inventory via Resource Graph
securityresources
| where type == "microsoft.security/softwareinventories"
| extend 
    VMName = tostring(properties.azureVmId),
    Software = tostring(properties.softwareName),
    Version = tostring(properties.version),
    Vendor = tostring(properties.vendor)
| project VMName, Software, Version, Vendor
| order by VMName, Software</code></pre>

                        <h3>Secrets Findings</h3>

                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Secret scanning findings
SecurityRecommendation
| where RecommendationName contains "secret" or RecommendationName contains "credential"
| where RecommendationState == "Unhealthy"
| project 
    Resource = AssessedResourceId,
    Finding = RecommendationDisplayName,
    Severity = RecommendationSeverity
| order by Severity desc</code></pre>
                    </section>

                    <!-- Exclusions -->
                    <section>
                        <h2 id="exclusions">Excluding VMs from Scanning</h2>

                        <p>Exclude specific VMs using Azure tags:</p>

                        <div class="code-header">
                            <span class="code-lang">Azure CLI</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-bash"># Add exclusion tag to VM
az vm update \
    --resource-group "your-rg" \
    --name "vm-to-exclude" \
    --set tags.intune-agent-skip-scanning=true

# Or for resource group-wide exclusion
az group update \
    --name "excluded-rg" \
    --set tags.intune-agent-skip-scanning=true</code></pre>

                        <div class="callout callout-warning">
                            <div class="callout-title">Tag Name</div>
                            <div class="callout-content">
                                <p>Use the exact tag: <code>intune-agent-skip-scanning</code> with value <code>true</code>. 
                                This is intentionally named differently to prevent accidental exclusions.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Agentless vs Agent -->
                    <section>
                        <h2 id="comparison">Agentless vs Agent-Based Scanning</h2>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>Agentless</th>
                                        <th>Agent-Based (MDE)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Deployment</strong></td>
                                        <td>None required</td>
                                        <td>Agent installation needed</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Performance Impact</strong></td>
                                        <td>Zero</td>
                                        <td>Minimal (~1-2% CPU)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Real-time Detection</strong></td>
                                        <td>âŒ No (24h scan cycle)</td>
                                        <td>âœ… Yes</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Runtime Threat Detection</strong></td>
                                        <td>âŒ No</td>
                                        <td>âœ… Yes (process, network)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Vulnerability Scanning</strong></td>
                                        <td>âœ… Yes</td>
                                        <td>âœ… Yes (TVM)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Secret Detection</strong></td>
                                        <td>âœ… Yes</td>
                                        <td>âŒ No</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Software Inventory</strong></td>
                                        <td>âœ… Yes</td>
                                        <td>âœ… Yes</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Offline VMs</strong></td>
                                        <td>âœ… Can scan</td>
                                        <td>âŒ Cannot</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="callout callout-tip">
                            <div class="callout-title">Best Practice</div>
                            <div class="callout-content">
                                <p>Use <strong>both</strong> agentless and agent-based scanning for comprehensive coverage. 
                                Agentless provides broad coverage and secret detection, while MDE provides real-time 
                                threat protection.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Key Takeaways -->
                    <div class="key-takeaways">
                        <div class="key-takeaways-title">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 2a.75.75 0 01.75.75v.258a33.186 33.186 0 016.668.83.75.75 0 01-.336 1.461z" clip-rule="evenodd" />
                            </svg>
                            Key Takeaways
                        </div>
                        <ul>
                            <li>Agentless scanning requires Defender CSPM or Servers P2</li>
                            <li>Zero performance impact - scans disk snapshots, not running VMs</li>
                            <li>Snapshots are temporary and deleted after scanning</li>
                            <li>Scans run every 24 hours automatically</li>
                            <li>Secret scanning finds exposed credentials in files</li>
                            <li>Use tags to exclude specific VMs from scanning</li>
                            <li>Combine with agent-based (MDE) for complete protection</li>
                            <li>Supports encrypted disks (ADE, PMK, CMK)</li>
                        </ul>
                    </div>

                    <div class="related-pages">
                        <div class="related-title">Related Pages</div>
                        <div class="related-list">
                            <a href="3-1-servers-overview.html" class="related-link">Defender for Servers</a>
                            <a href="3-3-mde-integration.html" class="related-link">MDE Integration</a>
                            <a href="2-3-attack-path.html" class="related-link">Attack Path Analysis</a>
                            <a href="12-1-kql-library.html" class="related-link">KQL Library</a>
                        </div>
                    </div>

                    <nav class="page-nav">
                        <a href="3-3-mde-integration.html" class="page-nav-link prev">
                            <span class="page-nav-label">â† Previous</span>
                            <span class="page-nav-title">MDE Integration</span>
                        </a>
                        <a href="3-15-jit-access.html" class="page-nav-link next">
                            <span class="page-nav-label">Next â†’</span>
                            <span class="page-nav-title">JIT VM Access</span>
                        </a>
                    </nav>
                </article>

                <aside class="toc-sidebar">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#how-it-works" class="toc-link">How It Works</a></li>
                        <li class="toc-item"><a href="#capabilities" class="toc-link">Capabilities</a></li>
                        <li class="toc-item"><a href="#prerequisites" class="toc-link">Prerequisites</a></li>
                        <li class="toc-item"><a href="#enablement" class="toc-link">Enablement</a></li>
                        <li class="toc-item"><a href="#view-results" class="toc-link">View Results</a></li>
                        <li class="toc-item"><a href="#exclusions" class="toc-link">Exclusions</a></li>
                        <li class="toc-item"><a href="#comparison" class="toc-link">Agentless vs Agent</a></li>
                    </ul>
                </aside>
            </div>
        </main>
        <div class="mobile-overlay"></div>
    </div>

    <div class="search-modal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" placeholder="Search documentation..." autofocus>
            <div class="search-results"></div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>
