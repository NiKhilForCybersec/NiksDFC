<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Vulnerability Management - Microsoft Defender Vulnerability Management integration with Defender for Cloud.">
    <title>Vulnerability Management - Microsoft Defender for Cloud</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">MDC</div>
                    <span class="logo-text">Defender for Cloud</span>
                </a>
                <button class="sidebar-toggle" aria-label="Toggle sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">CWPP</div>
                    <div class="nav-group expanded" data-group="cwpp-servers">
                        <div class="nav-group-header">
                            <span class="nav-group-title">Server Protection</span>
                            <svg class="nav-group-toggle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="nav-group-items">
                            <a href="3-1-servers-overview.html" class="nav-subitem">Servers Overview</a>
                            <a href="3-2-mde-integration.html" class="nav-subitem">MDE Integration</a>
                            <a href="3-3-vulnerability-mgmt.html" class="nav-subitem active">Vulnerability Management</a>
                            <a href="3-14-agentless-scanning.html" class="nav-subitem">Agentless Scanning</a>
                        </div>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" aria-label="Open menu">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10zm0 5.25a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <div class="search-box">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
                        </svg>
                        <input type="text" class="search-input" placeholder="Search documentation..." readonly>
                        <span class="search-shortcut">âŒ˜K</span>
                    </div>
                </div>
            </header>

            <div class="content-wrapper">
                <article class="page-content">
                    <nav class="breadcrumbs">
                        <a href="index.html" class="breadcrumb-item">Home</a>
                        <span class="breadcrumb-separator">/</span>
                        <a href="3-1-servers-overview.html" class="breadcrumb-item">CWPP</a>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item current">Vulnerability Management</span>
                    </nav>

                    <header class="page-header">
                        <h1>Vulnerability Management</h1>
                        <div class="page-meta">
                            <span class="badge badge-p2">Plan 2</span>
                            <span class="badge badge-l2">L2 Technical</span>
                            <span class="page-meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                                </svg>
                                13 min read
                            </span>
                        </div>
                    </header>

                    <section>
                        <p>
                            Microsoft Defender Vulnerability Management (MDVM) is integrated with Defender for 
                            Servers Plan 2, providing continuous vulnerability assessment, software inventory, 
                            and risk-based prioritization without requiring additional agents.
                        </p>

                        <div class="callout callout-info">
                            <div class="callout-title">Included with Defender for Servers P2</div>
                            <div class="callout-content">
                                <ul>
                                    <li><strong>Agent-based:</strong> Via MDE sensor (real-time)</li>
                                    <li><strong>Agentless:</strong> Via disk snapshot scanning</li>
                                    <li><strong>Coverage:</strong> Windows, Linux, containers</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- Architecture -->
                    <section>
                        <h2 id="architecture">Vulnerability Management Architecture</h2>

                        <div class="ascii-diagram">
<span class="highlight-cyan">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="highlight-cyan">â•‘</span>                      <span class="highlight-blue">VULNERABILITY MANAGEMENT ARCHITECTURE</span>                                <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£</span>
<span class="highlight-cyan">â•‘</span>                                                                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚                              PROTECTED RESOURCES                                â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚                                                                                  â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   â”‚  Windows    â”‚   â”‚   Linux     â”‚   â”‚ Containers  â”‚   â”‚   Registry  â”‚        â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   â”‚   Servers   â”‚   â”‚   Servers   â”‚   â”‚   (AKS)     â”‚   â”‚   (ACR)     â”‚        â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-blue">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>     <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>              â”‚                  â”‚                  â”‚                  â”‚                   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>              â–¼                  â–¼                  â–¼                  â–¼                   <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="highlight-purple">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="highlight-green">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚   MDE Agent      â”‚</span>  <span class="highlight-purple">â”‚   MDE Agent      â”‚</span>  <span class="highlight-green">â”‚      Agentless Scanning            â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â”‚   (Real-time)    â”‚</span>  <span class="highlight-purple">â”‚   (Real-time)    â”‚</span>  <span class="highlight-green">â”‚   (Disk snapshots, API scan)       â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-purple">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="highlight-purple">â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="highlight-green">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â”‚                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â–¼                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚                    MICROSOFT DEFENDER VULNERABILITY MANAGEMENT                     â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚                                                                                     â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚   â”‚   Software    â”‚   â”‚   CVE         â”‚   â”‚   Exposure    â”‚   â”‚   Security    â”‚   â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚   â”‚   Inventory   â”‚   â”‚   Database    â”‚   â”‚   Score       â”‚   â”‚   Baselines   â”‚   â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-orange">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â”‚                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                          â–¼                                                 <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”‚                          MICROSOFT DEFENDER FOR CLOUD                              â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â”‚                    (Unified view, recommendations, secure score)                   â”‚</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>   <span class="highlight-red">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•‘</span>                                                                                              <span class="highlight-cyan">â•‘</span>
<span class="highlight-cyan">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
                        </div>
                    </section>

                    <!-- Capabilities -->
                    <section>
                        <h2 id="capabilities">MDVM Capabilities</h2>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Capability</th>
                                        <th>Description</th>
                                        <th>Update Frequency</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Software Inventory</strong></td>
                                        <td>Complete list of installed applications, versions</td>
                                        <td>Real-time (agent), daily (agentless)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Vulnerability Detection</strong></td>
                                        <td>CVE identification across OS and applications</td>
                                        <td>Continuous</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Exposure Score</strong></td>
                                        <td>Risk-based prioritization (0-100)</td>
                                        <td>Daily</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Security Baselines</strong></td>
                                        <td>CIS benchmarks, Microsoft baselines</td>
                                        <td>Daily</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Browser Extensions</strong></td>
                                        <td>Risky browser extension detection</td>
                                        <td>Daily</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Certificates</strong></td>
                                        <td>Expiring/weak certificate detection</td>
                                        <td>Daily</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- Viewing Results -->
                    <section>
                        <h2 id="viewing">Viewing Vulnerability Data</h2>

                        <h3>In MDC Portal</h3>
                        <ol>
                            <li>Defender for Cloud â†’ Workload protections â†’ Machines</li>
                            <li>Select a VM â†’ Vulnerabilities tab</li>
                            <li>Or: Recommendations â†’ "Machines should have vulnerability findings resolved"</li>
                        </ol>

                        <h3>In MDE Portal</h3>
                        <ol>
                            <li>security.microsoft.com â†’ Vulnerability management</li>
                            <li>Dashboard shows exposure score, recommendations</li>
                            <li>Weaknesses â†’ Filter by severity/exploitability</li>
                        </ol>

                        <h3>KQL Queries</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL (MDE Advanced Hunting)</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Critical vulnerabilities on servers
DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel == "Critical"
| summarize VulnCount = count(), 
            CVEs = make_set(CveId) by DeviceName, SoftwareName
| order by VulnCount desc
| take 20</code></pre>

                        <div class="code-header">
                            <span class="code-lang">KQL (MDE Advanced Hunting)</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Exploitable vulnerabilities (EPSS > 0.5)
DeviceTvmSoftwareVulnerabilities
| where IsExploitAvailable == true
| join kind=inner (
    DeviceTvmSoftwareVulnerabilitiesKB
    | where EpssScore > 0.5
) on CveId
| project DeviceName, SoftwareName, CveId, 
          VulnerabilitySeverityLevel, EpssScore
| order by EpssScore desc</code></pre>

                        <div class="code-header">
                            <span class="code-lang">KQL (MDE Advanced Hunting)</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Software inventory with version
DeviceTvmSoftwareInventory
| where SoftwareVendor != ""
| summarize DeviceCount = dcount(DeviceId) by SoftwareName, SoftwareVersion
| order by DeviceCount desc
| take 50</code></pre>

                        <div class="code-header">
                            <span class="code-lang">KQL (Log Analytics)</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Vulnerability findings in MDC
SecurityResources
| where type == "microsoft.security/assessments/subassessments"
| where properties.id contains "vulnerability"
| extend 
    CVE = properties.id,
    Severity = properties.status.severity,
    Resource = properties.resourceDetails.id,
    Description = properties.description
| where Severity == "High" or Severity == "Critical"
| project CVE, Severity, Resource, Description</code></pre>
                    </section>

                    <!-- Prioritization -->
                    <section>
                        <h2 id="prioritization">Risk-Based Prioritization</h2>

                        <p>MDVM prioritizes vulnerabilities based on multiple factors:</p>

                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Factor</th>
                                        <th>Weight</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>CVSS Score</strong></td>
                                        <td>High</td>
                                        <td>Base vulnerability severity (0-10)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Exploit Available</strong></td>
                                        <td>High</td>
                                        <td>Known exploit code exists</td>
                                    </tr>
                                    <tr>
                                        <td><strong>EPSS Score</strong></td>
                                        <td>High</td>
                                        <td>Exploit Prediction Scoring System</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Threat Context</strong></td>
                                        <td>Medium</td>
                                        <td>Active exploitation in the wild</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Asset Value</strong></td>
                                        <td>Medium</td>
                                        <td>Business criticality of device</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Exposure</strong></td>
                                        <td>Medium</td>
                                        <td>Internet-facing, privileged access</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="callout callout-tip">
                            <div class="callout-title">Prioritization Strategy</div>
                            <div class="callout-content">
                                <p>Focus on vulnerabilities with:</p>
                                <ol>
                                    <li>Known exploits + EPSS &gt; 0.5</li>
                                    <li>Critical CVSS + internet-facing</li>
                                    <li>Active exploitation (CISA KEV)</li>
                                </ol>
                            </div>
                        </div>
                    </section>

                    <!-- Remediation -->
                    <section>
                        <h2 id="remediation">Remediation Workflow</h2>

                        <div class="accordion">
                            <div class="accordion-item expanded">
                                <div class="accordion-header">
                                    <span class="accordion-title">Windows Server Updates</span>
                                    <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="accordion-content">
                                    <div class="code-header">
                                        <span class="code-lang">PowerShell</span>
                                        <button class="code-copy-btn">Copy</button>
                                    </div>
                                    <pre><code class="language-powershell"># Check for available updates
Get-WindowsUpdate -MicrosoftUpdate

# Install security updates
Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -Category "Security Updates"

# Schedule via Azure Update Management
# Use Azure Automation for patch orchestration</code></pre>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <div class="accordion-header">
                                    <span class="accordion-title">Linux Server Updates</span>
                                    <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="accordion-content">
                                    <div class="code-header">
                                        <span class="code-lang">Bash</span>
                                        <button class="code-copy-btn">Copy</button>
                                    </div>
                                    <pre><code class="language-bash"># Ubuntu/Debian
sudo apt update && sudo apt upgrade -y

# RHEL/CentOS
sudo yum update -y --security

# Check for specific CVE fix
apt changelog package-name | grep CVE-2024-XXXX</code></pre>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <div class="accordion-header">
                                    <span class="accordion-title">Azure Update Manager</span>
                                    <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="accordion-content">
                                    <div class="code-header">
                                        <span class="code-lang">Azure CLI</span>
                                        <button class="code-copy-btn">Copy</button>
                                    </div>
                                    <pre><code class="language-bash"># Check update compliance
az maintenance update list \
    --resource-group "rg" \
    --resource-type "virtualMachines" \
    --resource-name "vm-name"

# Create maintenance configuration
az maintenance configuration create \
    --name "security-patches" \
    --resource-group "rg" \
    --maintenance-scope "InGuestPatch" \
    --install-patches-linux-parameters classificationToInclude="Security"</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Reporting -->
                    <section>
                        <h2 id="reporting">Vulnerability Reporting</h2>

                        <div class="code-header">
                            <span class="code-lang">PowerShell</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-powershell"># Export vulnerability findings to CSV
$subscriptionId = "YOUR-SUBSCRIPTION-ID"

# Get all vulnerability assessments
$assessments = Get-AzSecurityAssessment | 
    Where-Object { $_.DisplayName -like "*vulnerability*" }

# Get sub-assessments (individual CVEs)
$vulnerabilities = foreach ($assessment in $assessments) {
    Get-AzSecuritySubAssessment -AssessmentName $assessment.Name | 
        Select-Object @{N='CVE';E={$_.Id}},
                      @{N='Severity';E={$_.Status.Severity}},
                      @{N='Resource';E={$_.ResourceDetails.Id}},
                      @{N='Description';E={$_.Description}}
}

$vulnerabilities | Export-Csv -Path "vuln-report.csv" -NoTypeInformation</code></pre>

                        <h3>Executive Dashboard Query</h3>
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy-btn">Copy</button>
                        </div>
                        <pre><code class="language-kql">// Vulnerability summary for dashboard
DeviceTvmSoftwareVulnerabilities
| summarize 
    Critical = countif(VulnerabilitySeverityLevel == "Critical"),
    High = countif(VulnerabilitySeverityLevel == "High"),
    Medium = countif(VulnerabilitySeverityLevel == "Medium"),
    Low = countif(VulnerabilitySeverityLevel == "Low"),
    TotalDevices = dcount(DeviceId)
| extend TotalVulns = Critical + High + Medium + Low</code></pre>
                    </section>

                    <!-- Best Practices -->
                    <section>
                        <h2 id="best-practices">Best Practices</h2>

                        <div class="checklist">
                            <div class="checklist-title">Vulnerability Management Checklist</div>
                            <ul>
                                <li>
                                    <input type="checkbox" id="vuln1">
                                    <label for="vuln1">Enable Defender for Servers P2 for MDVM</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln2">
                                    <label for="vuln2">Enable agentless scanning for coverage gaps</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln3">
                                    <label for="vuln3">Prioritize by exploitability (EPSS) not just CVSS</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln4">
                                    <label for="vuln4">Track CISA KEV vulnerabilities separately</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln5">
                                    <label for="vuln5">Set SLAs: Critical 7 days, High 30 days</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln6">
                                    <label for="vuln6">Use Azure Update Manager for patching</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln7">
                                    <label for="vuln7">Report vulnerability trends to leadership weekly</label>
                                </li>
                                <li>
                                    <input type="checkbox" id="vuln8">
                                    <label for="vuln8">Exception process for unpatched systems</label>
                                </li>
                            </ul>
                        </div>
                    </section>

                    <!-- Key Takeaways -->
                    <div class="key-takeaways">
                        <div class="key-takeaways-title">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 2a.75.75 0 01.75.75v.258a33.186 33.186 0 016.668.83.75.75 0 01-.336 1.461z" clip-rule="evenodd" />
                            </svg>
                            Key Takeaways
                        </div>
                        <ul>
                            <li>MDVM included with Defender for Servers Plan 2</li>
                            <li>Agent-based (real-time) + agentless scanning options</li>
                            <li>Software inventory + CVE detection + security baselines</li>
                            <li>Prioritize by exploitability (EPSS), not just CVSS severity</li>
                            <li>Focus on CISA KEV (Known Exploited Vulnerabilities)</li>
                            <li>Use Azure Update Manager for patching at scale</li>
                            <li>Query with KQL in MDE or Log Analytics</li>
                            <li>Set remediation SLAs based on severity + exploitability</li>
                        </ul>
                    </div>

                    <div class="related-pages">
                        <div class="related-title">Related Pages</div>
                        <div class="related-list">
                            <a href="3-1-servers-overview.html" class="related-link">Servers Overview</a>
                            <a href="3-2-mde-integration.html" class="related-link">MDE Integration</a>
                            <a href="3-14-agentless-scanning.html" class="related-link">Agentless Scanning</a>
                            <a href="2-2-recommendations.html" class="related-link">Recommendations</a>
                        </div>
                    </div>

                    <nav class="page-nav">
                        <a href="3-2-mde-integration.html" class="page-nav-link prev">
                            <span class="page-nav-label">â† Previous</span>
                            <span class="page-nav-title">MDE Integration</span>
                        </a>
                        <a href="3-4-containers.html" class="page-nav-link next">
                            <span class="page-nav-label">Next â†’</span>
                            <span class="page-nav-title">Defender for Containers</span>
                        </a>
                    </nav>
                </article>

                <aside class="toc-sidebar">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#architecture" class="toc-link">Architecture</a></li>
                        <li class="toc-item"><a href="#capabilities" class="toc-link">Capabilities</a></li>
                        <li class="toc-item"><a href="#viewing" class="toc-link">Viewing Data</a></li>
                        <li class="toc-item"><a href="#prioritization" class="toc-link">Prioritization</a></li>
                        <li class="toc-item"><a href="#remediation" class="toc-link">Remediation</a></li>
                        <li class="toc-item"><a href="#reporting" class="toc-link">Reporting</a></li>
                        <li class="toc-item"><a href="#best-practices" class="toc-link">Best Practices</a></li>
                    </ul>
                </aside>
            </div>
        </main>
        <div class="mobile-overlay"></div>
    </div>

    <div class="search-modal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" placeholder="Search documentation..." autofocus>
            <div class="search-results"></div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>
